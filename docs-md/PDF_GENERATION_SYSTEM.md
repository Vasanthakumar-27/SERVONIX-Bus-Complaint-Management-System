# SERVONIX PDF Report Generation System

## Overview
Professional PDF generation system with SERVONIX branding, proper logo placement, data tables, and head administrator signature.

## Design Specifications

### ≡ƒôä PDF Layout Structure

```
ΓöîΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÉ
Γöé  ΓöîΓöÇΓöÇΓöÇΓöÇΓöÉ                                                  Γöé
Γöé  ΓöéLOGOΓöé          SERVONIX                                Γöé 
Γöé  Γöé ≡ƒôìΓöé   Bus Complaint Management System                Γöé
Γöé  ΓööΓöÇΓöÇΓöÇΓöÇΓöÿ                                                  Γöé
Γöé ΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇ  Γöé ΓåÉ Gold divider
Γöé                                                          Γöé
Γöé           Complaint/User/Admin Log Report                Γöé
Γöé  Generated: December 17, 2025 | Report Type: Complaints Γöé
Γöé                                                          Γöé
Γöé  Total Complaints/Users/Admins: XX                       Γöé
Γöé                                                          Γöé
Γöé ΓöîΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÉ    Γöé
Γöé Γöé Header 1 Γöé Header 2 Γöé Header 3 Γöé Header 4       Γöé    Γöé ΓåÉ Gold header
Γöé Γö£ΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöñ    Γöé
Γöé Γöé Row 1    Γöé Data     Γöé Data     Γöé Data           Γöé    Γöé ΓåÉ Alternating
Γöé Γöé Row 2    Γöé Data     Γöé Data     Γöé Data           Γöé    Γöé   colors
Γöé Γöé Row 3    Γöé Data     Γöé Data     Γöé Data           Γöé    Γöé
Γöé ΓööΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÿ    Γöé
Γöé                                                          Γöé
Γöé  [Watermark: SERVONIX - Transparent in center]          Γöé
Γöé                                                          Γöé
Γöé                              Authorized Signature:       Γöé ΓåÉ Last page
Γöé                                                          Γöé   bottom right
Γöé                              ___________________         Γöé
Γöé                              Head Administrator          Γöé
Γöé                              SERVONIX System             Γöé
Γöé                                                          Γöé
Γöé  Generated by SERVONIX | Confidential    Page 1 of 3    Γöé ΓåÉ Footer
ΓööΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÿ
```

## Features Implemented

### Γ£à Professional Header
- **Logo**: SERVONIX favicon (70x70 px)
- **System Name**: Large gold text "SERVONIX" (32pt, Helvetica Bold)
- **Tagline**: "Bus Complaint Management System" (10pt, gray)
- **Report Title**: Dynamic based on report type (20pt, bold)
- **Metadata**: Generation timestamp and report type
- **Gold Divider**: 2px horizontal line below header

### Γ£à Enhanced Tables
- **Gold Header Row**: #FFD100 background with black text
- **Alternating Row Colors**: Zebra striping for readability
  - Even rows: #F9FAFB (light gray)
  - Odd rows: White
- **Complete Borders**: 
  - Grid lines: 0.5px gray
  - Outer box: 2px black
  - Header underline: 2px black
- **Optimized Padding**: 10px top/bottom, 8px left/right
- **Column Widths**: Calculated based on content type

### Γ£à Watermark
- **Text**: "SERVONIX" in 120pt Helvetica Bold
- **Color**: Gold (#FFD100) with 8% opacity
- **Position**: Center of page, rotated for background effect
- **Purpose**: Brand protection and authenticity

### Γ£à Signature Block (Last Page, Bottom Right)
- **Label**: "Authorized Signature:"
- **Signature Line**: 40 underscores for manual signature
- **Title**: "Head Administrator" (11pt bold)
- **Organization**: "SERVONIX System" (9pt gray)
- **Alignment**: Right-aligned table for proper positioning

### Γ£à Footer (All Pages)
- **Left**: "Generated by SERVONIX | Confidential"
- **Right**: "Page X of Y"
- **Styling**: 9pt Helvetica, gray text
- **Position**: 30px from bottom

## Color Scheme

```css
Gold Primary:   #FFD100  /* Headers, branding */
Dark Text:      #1F2937  /* Body text */
Gray Secondary: #6B7280  /* Metadata, footer */
Black:          #000000  /* Borders, emphasis */
White:          #FFFFFF  /* Background */
Light Gray:     #F9FAFB  /* Alternating rows */
```

## API Endpoints

### 1. Export Complaints PDF
```
GET /api/head/export/complaints-pdf
Authorization: Bearer <token>
Response: application/pdf
```

**Includes:**
- User name and email
- District and route information
- Bus number and category
- Description and status
- Creation timestamp

### 2. Export Users PDF
```
GET /api/head/export/users-pdf
Authorization: Bearer <token>
Response: application/pdf
```

**Includes:**
- User ID, name, email
- District and phone number
- Registration date

### 3. Export Admins PDF
```
GET /api/head/export/admins-pdf
Authorization: Bearer <token>
Response: application/pdf
```

**Includes:**
- Admin ID, name, email
- Associated districts (comma-separated)
- Associated routes (comma-separated)
- Creation date

## Technical Implementation

### Backend (Python - ReportLab)

**File**: `backend/pdf_generator.py`

**Key Components:**
1. **WatermarkedCanvas**: Custom canvas class for watermarks and footers
2. **create_header()**: Professional header with logo and metadata
3. **create_table()**: Enhanced tables with alternating colors
4. **create_signature_block()**: Right-aligned signature section
5. **create_qr_code()**: QR code for authenticity verification

**Dependencies:**
```python
reportlab==4.0.7
qrcode==7.4.2
Pillow==10.1.0
```

### Frontend (JavaScript)

**File**: `frontend/js/head_dashboard.js`

**Functions:**
- `printAdmins()`: Downloads admin PDF report
- `printUsers()`: Downloads user PDF report
- `printAllComplaints()`: Downloads complaint PDF report

**Features:**
- Loading state with spinner
- Blob download handling
- Error handling with toast notifications
- Automatic filename with timestamp

## Usage Instructions

### For Head Admin:

1. **Navigate to Dashboard**
   - Login as head administrator

2. **Select Report Type**
   - Click "Print Admins" for admin list
   - Click "Print Users" for user list
   - Click "Print Complaints" for complaint log

3. **Download PDF**
   - Button shows "Generating PDF..." during creation
   - PDF automatically downloads to browser downloads folder
   - Success toast notification appears

4. **PDF Filename Format**
   ```
   admins_report_1702819200000.pdf
   users_report_1702819200000.pdf
   complaints_report_1702819200000.pdf
   ```
   (Timestamp = milliseconds since epoch)

## Quality Assurance

### Γ£à Checklist
- [x] SERVONIX logo displays correctly
- [x] System name and tagline present
- [x] Report title dynamic per type
- [x] Timestamp in readable format
- [x] Summary statistics (total count)
- [x] Tables with proper headers
- [x] Alternating row colors
- [x] Complete grid borders
- [x] Watermark on all pages
- [x] Signature block on last page
- [x] Footer with page numbers
- [x] Professional A4 formatting
- [x] Proper margins (50mm all sides)

## Example Output

### Complaint Report Table Structure
| Name       | Email           | District | Route      | Bus   | Category | Created    |
|------------|-----------------|----------|------------|-------|----------|------------|
| John Doe   | john@email.com  | Central  | Route 101  | TN123 | Delay    | 2024-12-17 |
| Jane Smith | jane@email.com  | North    | Route 205  | TN456 | Safety   | 2024-12-16 |

### Admin Report Table Structure
| ID | Name       | Email           | Districts    | Routes              |
|----|------------|-----------------|--------------|---------------------|
| 1  | Admin User | admin@email.com | Central,East | Route 101, Route 205|

### User Report Table Structure
| ID | Name       | Email          | District | Phone        | Registered |
|----|------------|----------------|----------|--------------|------------|
| 5  | User Name  | user@email.com | Central  | 9876543210   | 2024-12-15 |

## Troubleshooting

### Issue: Logo not displaying
**Solution**: Verify `favicon.png` exists in project root or backend folder

### Issue: PDF download fails
**Solution**: Check browser console for errors, verify token authentication

### Issue: Signature not on last page
**Solution**: Signature block uses `KeepTogether` - ensure sufficient page space

### Issue: Watermark too dark
**Solution**: Opacity set to 8% (0.08) - adjust in `_add_watermark()` method

## Future Enhancements

- [ ] Add QR code with verification URL
- [ ] Include statistical charts (pie/bar charts)
- [ ] Multi-language support
- [ ] Custom date range filtering
- [ ] Email PDF reports
- [ ] Batch export with ZIP compression
- [ ] Digital signature integration
- [ ] Report scheduling and automation

## Security Notes

- All endpoints require head authentication
- PDFs stored in temporary directory
- Auto-cleanup after download
- Confidentiality notice in footer
- Watermark prevents forgery

---

**Last Updated**: December 17, 2025  
**Version**: 1.0.0  
**Author**: SERVONIX Development Team
